# OS  

</br>

## Outline
- [메모리 영역 구조](#메모리-영역-구조)
- [프로세스와 쓰레드](#프로세스와-쓰레드)
- [프로세스 통신 (IPC)](#프로세스-통신)
- [동기와 비동기](#프로세스-통신)
- [캐시 메모리](#캐시-메모리)
- [스케줄링](#스케줄링)

</br>

## 메모리 영역 구조
#### 1) code 영역
- 코드 자체, 실행파일을 구성하는 메모리 영역. (Hex파일이나 BIN파일 메모리)  
- 프로그램 명령이 위치하는 곳으로 기계어로 제어되는 메모리 영역

#### 2) data 영역  
- 전역변수(global), 정적변수(static), 배열(array), 구조체(structure) 등이 저장됨.  
  - 초기화 된 데이터 : data
  - 초기화 되지 않은 데이터 : BSS (Block Stated Symbol)   
- 프로그램이 실행 될 때 생성되고 프로그램이 종료 되면 시스템에 반환됨.  
- 함수 내부에 선언된 Static 변수는 프로그램이 실행 될 때 공간만 할당되고, 그 함수가 실행 될 때 초기화됨.

#### 3) heap 영역
- 필요에 의해 동적으로 메모리를 할당 하고자 할 때 위치하는 메모리 영역으로, 메모리 주소 값에 의해서만 참조되고 사용되는 영역.  
- C는 malloc(), C++은 new() 함수를 사용.

#### 4) stack 영역
- 프로그램이 자동으로 사용하는 임시 메모리 영역.  
- 지역(local) 변수, 매개변수(parameter), 리턴 값 등 잠시 사용되었다가 사라지는 데이터를 저장  
- 함수 호출 시 생성되고, 함수 return시 시스템에 반환됨  
- 스택 사이즈는 각 프로세스마다 할당 되지만 프로세스가 메모리에 로드 될 때 스택 사이즈가 고정되어 있어, 런타임 시에 스택 사이즈를 바꿀 수는 없음.  
- 명령 실행시 자동 증가 혹은 감소 하기 때문에 보통 메모리의 마지막 번지를 지정  

</br>

## 프로세스와 쓰레드
- 공통점
  - 특정 순서로 실행해야 할 명령 시퀀스를 나타내는 비동기적 행위  
- 프로세스
  - 운영체제 내에 존재. 레지스터, 스택, 포인터, 데이터의 복합으로 각각 별개의 메모리 공간을 가짐    
  - 운영체제 내에 프로세스를 컨트롤하는 PCB(Process Control Block)가 존재  
  - 프로세스간 전환 속도가 쓰레드 간 전환 속도보다 느림  
- 쓰레드
  - 쓰레드는 프로세스 내에 존재. 
  - 하나의 프로그램 내에서의 실행 단위를 말함.  
  - 메모리를 공유해서 사용할 수 있음.  
  - context switching이 가벼움

</br>

## 프로세스 통신 (IPC)
#### 1) 시그널 ( 프로세스(커널포함) <-> 프로세스 in 동일 시스템 ) 
- 프로세스간의 인터럽트 처리를 위한 동기화를 위한 것이라면 시그널 방식을 선택 
- 결과는 대부분 프로세스 종료. 혹은 프로그래머가 지정한 시그널핸들러 함수를 실행 
- 주로 커널이 보내지만, 해당 프로세스에 권한을 가진 프로세스도 시그널 보낼수 있음. 

#### 2) 파이프 ( 프로세스 <-> 프로세스 in 동일 시스템 )  
- 동일한 시스템 내에서 메시지를 주고받는 것이라면 파이프를 선택
- 파일 아웃풋 -> 파일인풋  - 반이중통신으로 이중통신을 위해 2개 파이프 필요. 

#### 3) 소켓 ( 프로세스 <-> 프로세스 in 외부 시스템 )  
- 서로 다른 시스템에 프로세스끼리 메시지를 주고받는 것이라면 소켓을 선택 
- 연결형모델 TCP / 비연결형 UDP

참고
1. https://jwprogramming.tistory.com/54
2. https://gomoveyongs.tistory.com/m/67

</br>

## 동기와 비동기
#### 1) 동기
- 메소드 실행과 동시에 반환 값 기대됨
- ex) A노드와 B노드 사이의 작업 처리 단위(transaction)를 동시에 맞추겠다!
- 설계가 매우 간단하고 직관적이라는 장점이 있음
- 결과가 주어질 때까지 아무것도 못하고 대기해야 하는 단점이 있음

#### 2) 비동기
- 실행과 동시에 반환 값 기대되지 않음
- ex) 노드 사이의 작업 처리 단위를 동시에 맞추지 않아도 됨
- 동기보다 복잡하다는 단점이 있음
- 결과가 주어지는데 시간이 걸리더라도 그 시간 동안 다른 작업을 할 수 있으므로 자원을 효율적으로 사용할 수 있다는 장점이 있음

## 캐시 메모리
#### 1) 정의
- 속도가 빠른 장치와 느린 장치간의 속도차에 따른 병목 현상을 줄이기 위한 범용 메모리

#### 2) Cache mapping 방식 3가지
- fully associative
- direct map
- set associative

참고 : http://egloos.zum.com/rantis7/v/2879608

## 스케줄링
#### Stride Scheduling
- 비결정적인(Non-deterministic) Lottery에 반해서 결정적인(deterministic)스케줄링 방식
- 티켓 수에 역수를 취한 값을 stride라 하고, stride 값에 따라 pass 값을 갱신하고 pass 값에 따라 스케줄링 하는 방식.

참고 : https://wkdtjsgur100.github.io/scheduling-1/

</br>

## 교착상태(Deadlock)
#### 1) 정의
- 일련의 프로세스들이 서로가 가진 자원을 요청하고 기다리며 무한 대기하는 상태
- ex) 프로세스 P1, P2가 각각 자원 a, b를 할당받은 상태에서 P1은 b를, P2는 a를 요청한 상태

#### 2) 4가지 조건
1) 상호배제 : 한번에 한 프로세스만 공유 자원을 사용할 수 있다.
2) 점유대기 : 하나의 자원을 갖고 있는 프로세스가 다른 자원을 기다리고 있다.
3) 비선점 : 한 프로세스가 다른 프로세스의 자원 접근 권한을 강제로 취소할 수 없다.
4) 순환대기 : 두 개 이상의 프로세스가 자원 접근을 기다리는데, 그 관계에 사이클이 존재한다.

#### 3) 방지 방법
- 위 4가지 조건 중 하나를 제거하면 된다.
- 공유 자원 중 많은 경우가 한 번에 한 프로세스만 사용할 수 있기 때문에 1번 조건(상호배제)은 제거하기 어렵다.
- 대부분의 교착상태 방지 알고리즘은 4번 조건, 즉 대기 상태의 사이클이 발생하는 일을 막는 데 초점이 맞춰져 있다.



